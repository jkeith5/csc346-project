import org.jsoup.Jsoup;
import org.jsoup.nodes.Document;
import org.jsoup.nodes.Element;
import org.jsoup.select.Elements;
import java.io.IOException;
import java.util.ArrayList;

public class Main {

    public static void main(String[] args) {
        String websiteDnD = "https://aps2.missouriwestern.edu/schedule/Default.asp?tck=201910";//disciplines and depts
        ArrayList<String> disciplinesAbbrev = new ArrayList<>();
        ArrayList<String> disciplinesFull= new ArrayList<>();
        ArrayList<String> deptsAbbrev = new ArrayList<>();
        ArrayList<String> deptsFull= new ArrayList<>();
        Sqlite db=new Sqlite();

        try {
            Document docDisc= Jsoup.connect(websiteDnD).get();
            Elements discOptions=docDisc.select("#subject option");//finds the label with id=subject and pulls all option tags from it
            System.out.println("-------");
            for (Element option : discOptions){
                System.out.println(option);//prints all options including all the html info
                addToArraylist(disciplinesAbbrev,disciplinesFull,option.val(),option.text());

            }
            disciplinesAbbrev.remove(0);//removes the first entry which is a title of sorts.
            disciplinesFull.remove(0);//see above comment
            System.out.println(disciplinesAbbrev.get(0)+", "+disciplinesFull.get(1));
            Elements deptsOptions=docDisc.select("#department option");//finds the label with id=department and pulls option tags
            System.out.println("----");
            for (Element option: deptsOptions){
                System.out.println(option);
                addToArraylist(deptsAbbrev,deptsFull,option.val(),option.text());
            }
            deptsAbbrev.remove(0);//removes the title
            deptsFull.remove(0);//removes the title
            System.out.println(deptsAbbrev.get(0)+", "+deptsFull.get(1));
        } catch (IOException e) {
            ///e.printStackTrace();
            System.err.println("Error: "+e.getMessage());
        }
        if (db.makeConnection("scraping.db")){
            System.out.println("Database opened!");
            addToDatabase(disciplinesAbbrev,disciplinesFull,"subjects",db);
            addToDatabase(deptsAbbrev,deptsFull,"departments",db);
        }else{
            System.out.println("Database failed to open!");
        }
    }
    public static void addToDatabase(ArrayList<String> abbrev,ArrayList<String> fullName,String tableName, Sqlite db){
        for (int i=0;i<abbrev.size();i++) {
            db.insert(tableName, abbrev.get(i), fullName.get(i));
        }
    }
    public static void addToArraylist(ArrayList<String> addVal,ArrayList<String> addFull, String val, String full){//adds scraped data into arraylists
        addVal.add(val);
        addFull.add(full);
    }

}
